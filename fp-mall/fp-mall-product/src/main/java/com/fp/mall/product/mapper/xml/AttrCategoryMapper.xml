<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.fp.mall.product.mapper.AttrCategoryMapper">

    <resultMap id="categoryVO" type="CategoryVO">
        <id column="id" property="id"/>
        <result column="level" property="level"/>
        <result column="parent_id" property="parentId"/>
        <result column="name" property="name"/>
        <result column="desc" property="desc"/>
        <result column="icon_url" property="iconUrl"/>
        <result column="status" property="status"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
    </resultMap>

    <!-- ======================================================================= -->

    <select id="listCategoryIdsByAttrId" parameterType="Long" resultType="List">
        select `category_id` from `attr_category` where `attr_id` = #{attrId}
    </select>

    <insert id="saveBatch">
        insert into `attr_category` (attr_id, category_id) values
        <foreach collection="categoryIds" item="categoryId" separator=",">
            (#{attrId}, #{categoryId})
        </foreach>
    </insert>

    <update id="deleteBatch">
        delete from `attr_category` where `attr_id` = #{attrId}
        and `category_id` in
        <foreach collection="categoryIds" item="categoryId" open="(" separator="," close=")">
            #{categoryId}
        </foreach>
    </update>

</mapper>