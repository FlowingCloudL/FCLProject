<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.fp.mall.product.mapper.SpuBasicAttrMapper">

    <select id="listSpuBasicAttrsBySpuId" parameterType="Long" resultType="SpuBasicAttrVO">
        select * from `spu_basic_attr` where `spu_id` = #{spuId}
    </select>

    <select id="listSpuIdsByAttrValueIds">
        select `spu_id` from `spu_basic_attr` where `attr_value_id` in
        <foreach collection="attrValueIds" item="attrValueId" open="(" separator="," close=")">
            #{attrValueId}
        </foreach>
    </select>

    <insert id="save" parameterType="SpuBasicAttrEntity">
        insert into `spu_basic_attr` (spu_id, attr_id, attr_name, attr_value_id, attr_value)
        value (#{entity.spuId}, #{entity.attrId}, #{entity.attrName},
               #{entity.attrValueId}, #{entity.attrValue})
    </insert>

    <insert id="saveBatch">
        insert into `spu_basic_attr` (spu_id, attr_id, attr_name, attr_value_id, attr_value) values
        <foreach collection="entityList" item="entity" separator=",">
            (#{entity.spuId}, #{entity.attrId}, #{entity.attrName},#{entity.attrValueId}, #{entity.attrValue})
        </foreach>
    </insert>

    <update id="updateAttr">
        update `spu_basic_attr` set `attr_name` = #{attrName} where `attr_id` = #{attrId}
    </update>

    <update id="updateAttrValue">
        update `spu_basic_attr` set `attr_value` = #{attrValue} where `attr_value_id` = #{attrValueId}
    </update>

    <delete id="deleteBySpuId" parameterType="Long">
        delete from `spu_basic_attr` where `spu_id` = #{spuId}
    </delete>

    <delete id="deleteBatchById">
        delete from `spu_basic_attr` where `id` in
        <foreach collection="idList" item="id" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <delete id="deleteByAttIdAndAttrValueIds">
        delete from `spu_basic_attr` where `attr_id` = #{attrId}
        <if test="attrValueIds != null">
            and `attr_value_id` in
            <foreach collection="attrValueIds" item="attrValueId" open="(" separator="," close=")">
                #{attrValueId}
            </foreach>
        </if>
    </delete>


</mapper>